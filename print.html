<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>React-Node.js</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="day01/index.html"><strong aria-hidden="true">1.</strong> Day01</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="day01/about-react.html"><strong aria-hidden="true">1.1.</strong> Reactとは</a></li><li class="chapter-item expanded "><a href="day01/construct-app.html"><strong aria-hidden="true">1.2.</strong> アプリケーション実装の準備</a></li><li class="chapter-item expanded "><a href="day01/use-component.html"><strong aria-hidden="true">1.3.</strong> コンポーネント</a></li><li class="chapter-item expanded "><a href="day01/use-props.html"><strong aria-hidden="true">1.4.</strong> propsの活用</a></li><li class="chapter-item expanded "><a href="day01/use-router.html"><strong aria-hidden="true">1.5.</strong> router機能</a></li><li class="chapter-item expanded "><a href="day01/props-function.html"><strong aria-hidden="true">1.6.</strong> 子コンポーネントへの関数入力</a></li><li class="chapter-item expanded "><a href="day01/http-request.html"><strong aria-hidden="true">1.7.</strong> httpリクエストの実装</a></li><li class="chapter-item expanded "><a href="day01/ui.html"><strong aria-hidden="true">1.8.</strong> 表示の調整</a></li><li class="chapter-item expanded "><a href="day01/work.html"><strong aria-hidden="true">1.9.</strong> 課題（任意）</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">React-Node.js</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        

                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="day01"><a class="header" href="#day01">Day01</a></h1>
<h2 id="今回のゴール"><a class="header" href="#今回のゴール">今回のゴール</a></h2>
<ul>
<li>React の基本的な処理を知り，実装を行う．</li>
<li>コンポーネントの組み合わせやデータの受け渡しを理解する．</li>
<li>外部との通信を実装し，データの扱い方や注意点を理解する．</li>
</ul>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="reactとは"><a class="header" href="#reactとは">Reactとは</a></h1>
<ul>
<li>ユーザインターフェース構築のための JavaScript ライブラリ</li>
</ul>
<h2 id="宣言的な-view"><a class="header" href="#宣言的な-view">宣言的な View</a></h2>
<ul>
<li>React は、インタラクティブなユーザインターフェイスの作成にともなう苦痛を取り除きます．アプリケーションの各状態に対応するシンプルな View を設計するだけで，React はデータの変更を検知し，関連するコンポーネントだけを効率的に更新，描画します．</li>
<li>宣言的な View を用いてアプリケーションを構築することで，コードはより見通しが立ちやすく，デバッグのしやすいものになります．</li>
</ul>
<h2 id="コンポーネントベース"><a class="header" href="#コンポーネントベース">コンポーネントベース</a></h2>
<ul>
<li>自分自身の状態を管理するカプセル化されたコンポーネントをまず作成し，これらを組み合わせることで複雑なユーザインターフェイスを構築します．</li>
<li>コンポーネントのロジックは，Template ではなく JavaScript そのもので書くことができるので，様々なデータをアプリケーション内で簡単に取り回すことができ，かつ DOM に状態を持たせないようにすることができます．</li>
</ul>
<h2 id="一度学習すればどこでも使える"><a class="header" href="#一度学習すればどこでも使える">一度学習すれば、どこでも使える</a></h2>
<ul>
<li>React と組み合わせて使用する技術に制限はありません．React を使って新しい機能を追加する際に，既存のソースコードを書き換える必要はありません．</li>
<li>React は Node を使ったサーバー上でもレンダーできますし，React Native を使うことでモバイルアプリケーションの中でも動きます．</li>
</ul>
<h2 id="で結局なんなのじゃ"><a class="header" href="#で結局なんなのじゃ">で，結局なんなのじゃ？</a></h2>
<ul>
<li>描画などの面倒な処理をいい感じにやってくれる．</li>
<li>画面に表示したいパーツ（コンポーネント）ごとに記述するので他の部分に影響しづらく，使い回しが効く．</li>
<li>ライブラリが充実しているのでだいたいのことはわりと簡単にできる．</li>
</ul>
<h2 id="今回作成するアプリケーション"><a class="header" href="#今回作成するアプリケーション">今回作成するアプリケーション</a></h2>
<ul>
<li>オススメ本を表示する SPA．</li>
<li>ページごとにカテゴリ別の本が一覧で表示される．</li>
<li>本のデータ Google books API から読み込んで表示する．</li>
</ul>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="アプリケーション実装の準備"><a class="header" href="#アプリケーション実装の準備">アプリケーション実装の準備</a></h1>
<h2 id="必要なツールのバージョン確認"><a class="header" href="#必要なツールのバージョン確認">必要なツールのバージョン確認</a></h2>
<ul>
<li>Node.js と npm が必要なので，以下のコマンドで状況を確認する．</li>
<li>バージョンが表示されれば OK．</li>
</ul>
<pre><code class="language-bash">$ node -v
v14.15.3
$ npm -v
7.15.0
</code></pre>
<h2 id="プロジェクトの作成"><a class="header" href="#プロジェクトの作成">プロジェクトの作成</a></h2>
<ul>
<li>React はプロジェクト単位でアプリケーションを開発する．</li>
<li>専用のコマンドが用意されているので，以下のようにプロジェクトを作成する．</li>
<li><code>npx</code>を使用すると，インストールしていないパッケージを実行できる．グローバルに残らないので，汚染の心配がない．</li>
<li>最後の<code>react-app</code>はプロジェクト名なので好きな名前で OK．</li>
</ul>
<pre><code class="language-bash">$ npx create-react-app react-app
</code></pre>
<p>※<code>npm</code>ではなく<code>npx</code>である点に注意！</p>
<p>いい感じにできたら，以下のコマンドでディレクトリに移動し，サーバを起動する．</p>
<pre><code class="language-bash">$ cd react-app
$ npm start
</code></pre>
<p>自動的にブラウザが立ち上がり，以下のような画面が表示されれば OK．</p>
<p><img src="day01/./img/firstview.png" alt="初期画面の画像" /></p>
<p>サーバはターミナル上で<code>control + c</code>すると停止できる．</p>
<blockquote>
<p><strong>💡 Key Point</strong></p>
<p>React の開発手順について</p>
<ul>
<li><code>npm start</code>を実行した状態でファイルを編集すると自動的にコンパイルが行われ，最新の状態がブラウザ画面に反映される．</li>
<li><code>npm start</code>実行 -&gt; vs code でコード編集 -&gt; ブラウザで動作確認 の繰り返し．</li>
<li>ライブラリ追加時などはサーバを再起動しないと反映されないため．動作しない場合は<code>control + c</code>して再度<code>npm start</code>でサーバを起動する．</li>
</ul>
</blockquote>
<h2 id="react-の大まかな仕組み"><a class="header" href="#react-の大まかな仕組み">React の大まかな仕組み</a></h2>
<ul>
<li>アプリケーションは全て<code>public/index.html</code>上で実行される．</li>
<li>実行時には<code>src/index.js</code>が実行され，<code>App</code>コンポーネントが<code>index.html</code>上にマウントされる．</li>
<li>実際に画面に表示されるのは<code>App.js</code>内に記述された内容となる．</li>
<li>この<code>App.js</code>から様々なコンポーネントを読み込むことでアプリケーションが動作する．</li>
</ul>
<h2 id="メイン画面の編集と不要なファイルの削除"><a class="header" href="#メイン画面の編集と不要なファイルの削除">メイン画面の編集と不要なファイルの削除</a></h2>
<p>メインの画面は<code>App.js</code>であり，このファイルが<code>index.html</code>の<code>id=root</code>に描画される．</p>
<p>初期状態では<code>App.js</code>に不要な記述が含まれているため削除する．合わせて使用しないファイルも削除する．</p>
<p><code>App.js</code>のファイル名を<code>App.jsx</code>に変更し，内容を以下のように編集する．</p>
<pre><code class="language-jsx">// App.jsx
import React from &quot;react&quot;;

const App = () =&gt; {
  return (
    &lt;&gt;
      &lt;h1&gt;react app&lt;/h1&gt;
    &lt;/&gt;
  );
};
export default App;
</code></pre>
<p>以下のファイルを削除する．</p>
<ul>
<li><code>src/App.css</code></li>
<li><code>src/App.test.js</code></li>
<li><code>src/logo.svg</code></li>
</ul>
<p>また，<code>index.js</code>の内容を以下のように編集する．</p>
<pre><code class="language-js">// index.js
import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';
import reportWebVitals from './reportWebVitals';

ReactDOM.render(
  &lt;React.StrictMode&gt;
    &lt;App /&gt;
  &lt;/React.StrictMode&gt;,
  document.getElementById('root')
);

reportWebVitals();

</code></pre>
<p>以下のコマンドで開発サーバを起動する．</p>
<pre><code class="language-bash">$ npm start
</code></pre>
<p>ブラウザ画面を確認すると以下のようになっている．
<img src="day01/./img/mainview01.png" alt="メイン画面1" /></p>
<blockquote>
<p>【補足】js と jsx</p>
<ul>
<li>js：Javascript のファイル．</li>
<li>jsx：React 要素を生成する Javascript の拡張．React ではこちらを使うとたくさんいいことがある．</li>
</ul>
</blockquote>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="コンポーネント"><a class="header" href="#コンポーネント">コンポーネント</a></h1>
<p>ここから，実際にコンポーネントを実装してみる．</p>
<p>まずは必要なファイルを準備しよう．</p>
<ul>
<li><code>src</code>ディレクトリに<code>components</code>ディレクトリを作成する．</li>
<li><code>components</code>ディレクトリ内に<code>Booklist.jsx</code>を作成する．</li>
<li><code>Booklist.jsx</code>に以下の内容を記述する．</li>
</ul>
<pre><code class="language-jsx">// Booklist.jsx
import React from &quot;react&quot;;

export const Booklist = (props) =&gt; {
  return (
    &lt;&gt;
      &lt;p&gt;this is book list component&lt;/p&gt;
    &lt;/&gt;
  );
};

</code></pre>
<blockquote>
<p>【解説】コンポーネントの作成</p>
<ul>
<li>コンポーネントには「class コンポーネント」と「関数コンポーネント」の 2 種類が存在する．</li>
<li>class コンポーネントは「状態を持つことができる（ステートフル）」という特徴があるが，関数コンポーネントでは「状態を持つことができない（ステートレス）」．</li>
<li>しかし，関数コンポーネントでも「React hooks」という技術を使うことで同様の振る舞いを実現することができる．</li>
<li>「state」というのはコンポーネント自体が持つ値であり，他にコンポーネントが外から受け取る「props」が存在する．</li>
<li>コンポーネント作成の際には，できるだけ state を持たないよう設計すると動作確認が楽になるだけでなく，バグの生まれる可能性も低減できる．</li>
<li>そのため，本記事ではすべて関数コンポーネントを使用してアプリケーションを構築し，必要に応じて「React hooks」を使用して状態を管理する．</li>
</ul>
</blockquote>
<h2 id="コンポーネントの構造"><a class="header" href="#コンポーネントの構造">コンポーネントの構造</a></h2>
<ul>
<li><code>import ...</code>は必要なライブラリを読み込む．</li>
<li>関数<code>Booklist</code>は呼び出し元のコンポーネントから<code>props</code>を受け取り，html要素を出力する．</li>
<li><code>export const Booklist = ...</code>とすることで，他のコンポーネントから<code>import { Booklist } ...</code>のように記述して呼び出せるようにしている．</li>
</ul>
<h2 id="コンポーネントの呼び出し1"><a class="header" href="#コンポーネントの呼び出し1">コンポーネントの呼び出し（1）</a></h2>
<p><code>Booklist</code>コンポーネントを作成したので，<code>App</code>コンポーネントから呼び出してみる．</p>
<p><code>App.jsx</code>を以下のように編集する．</p>
<pre><code class="language-jsx">// App.jsx
import React from &quot;react&quot;;
import { Booklist } from &quot;./components/Booklist&quot;; // 追加（コンポーネントのimport）

const App = () =&gt; {
  return (
    &lt;&gt;
      &lt;h1&gt;react app&lt;/h1&gt;
      &lt;Booklist /&gt;
    &lt;/&gt;
  );
};
export default App;

</code></pre>
<p>ブラウザで表示を確認すると以下のようになっている．</p>
<p><img src="day01/./img/mainview02.png" alt="メイン画面2" /></p>
<p>また，検証画面を確認すると，以下のように Booklist コンポーネントが読み込まれていることがわかる．</p>
<p><img src="day01/./img/elements01.png" alt="検証画面1" /></p>
<h2 id="コンポーネントの呼び出し2"><a class="header" href="#コンポーネントの呼び出し2">コンポーネントの呼び出し（2）</a></h2>
<p>呼び出すコンポーネントを 2 つにしてみる．</p>
<p><code>App.jsx</code>を以下のように編集する．</p>
<pre><code class="language-jsx">// App.jsx
import React from &quot;react&quot;;
import { Booklist } from &quot;./components/Booklist&quot;;

const App = () =&gt; {
  return (
    &lt;&gt;
      &lt;h1&gt;react app&lt;/h1&gt;
      &lt;Booklist /&gt;
      &lt;Booklist /&gt;
    &lt;/&gt;
  );
};
export default App;
</code></pre>
<p>ブラウザ画面で，<code>Booklist</code>コンポーネントが 2 つ表示されていることを確認しよう．</p>
<p>このように，作成したコンポーネントは複数使用することもできる．</p>
<p><img src="day01/./img/mainview03.png" alt="メイン画面3" /></p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="propsの活用"><a class="header" href="#propsの活用">propsの活用</a></h1>
<p><code>props</code>は呼び出し元のコンポーネント（親コンポーネント）から呼び出されたコンポーネント（子コンポーネント）に渡されるデータの塊である．</p>
<blockquote>
<p><strong>💡 Key Point</strong></p>
<p>Reactのコンポーネントは「関数」であり，入力と出力がある．「入力」に当たるのがこの<code>props</code>である．</p>
</blockquote>
<h2 id="propsでデータを渡す"><a class="header" href="#propsでデータを渡す"><code>props</code>でデータを渡す</a></h2>
<p>実際に<code>App</code>コンポーネントから<code>Booklist</code>コンポーネントに文字列のデータを渡してみよう．</p>
<p><code>App.jsx</code>を以下のように編集する．</p>
<pre><code class="language-jsx">// App.jsx
import React from &quot;react&quot;;
import { Booklist } from &quot;./components/Booklist&quot;;

const App = () =&gt; {
  const languages = [&quot;React&quot;, &quot;Vue&quot;, &quot;Angular&quot;];
  return (
    &lt;&gt;
      &lt;h1&gt;react app&lt;/h1&gt;
      &lt;Booklist language={languages[0]} /&gt;
      &lt;Booklist /&gt;
    &lt;/&gt;
  );
};
export default App;

</code></pre>
<p>ここでは，「<code>App</code>コンポーネントから<code>Booklist</code>コンポーネントに」「<code>language</code>という名前で」「<code>languages[0]</code>の値」を渡している．</p>
<p>タグ内に変数を入れるときは<code>{}</code>を使用する．</p>
<h2 id="propsでデータを受け取る"><a class="header" href="#propsでデータを受け取る"><code>props</code>でデータを受け取る</a></h2>
<p>続いて，値を渡される<code>Booklist.jsx</code>を以下のように編集する．</p>
<pre><code class="language-jsx">// Booklist.jsx
import React from &quot;react&quot;;

export const Booklist = ({ language }) =&gt; {
  return (
    &lt;&gt;
      &lt;p&gt;this is {language} list component&lt;/p&gt;
    &lt;/&gt;
  );
};

</code></pre>
<p>ブラウザで画面を確認すると以下のような状態になる．</p>
<p>1つめのコンポーネントは<code>React</code>の文字列が追加されているが，2つめのコンポーネントには追加されていない．なぜだろうか．</p>
<p><img src="day01/./img/mainview04.png" alt="メイン画面4" /></p>
<p>1つめのコンポーネントには<code>App.jsx</code>で<code>language={languages[0]}</code>が記述されているが，2つめでは記述されていない．そのため，2つめのコンポーネントでは<code>props</code>が空の状態となっており表示が追加されない．</p>
<h2 id="追加"><a class="header" href="#追加">追加！</a></h2>
<p>2つめのコンポーネントにもデータを渡すには次のように<code>App.jsx</code>を編集する．</p>
<p>（ついでにコンポーネントを追加！）</p>
<pre><code class="language-jsx">// App.jsx
import React from &quot;react&quot;;
import { Booklist } from &quot;./components/Booklist&quot;;

const App = () =&gt; {
  const languages = [&quot;React&quot;, &quot;Vue&quot;, &quot;Angular&quot;];
  return (
    &lt;&gt;
      &lt;h1&gt;react app&lt;/h1&gt;
      &lt;Booklist language={languages[0]} /&gt;
      &lt;Booklist language={languages[1]} /&gt;
      &lt;Booklist language={languages[2]} /&gt;
    &lt;/&gt;
  );
};
export default App;

</code></pre>
<p>こうなる！</p>
<p><img src="day01/./img/mainview05.png" alt="メイン画面5" /></p>
<blockquote>
<p><strong>💡 Key Point</strong></p>
<p>このように，関数コンポーネントは<code>props</code>を受け取り，要素を返す関数となる．実装するときは「何を入力して」「何を出力するのか」を意識すると（多分）混乱せずすすめることができる．</p>
</blockquote>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="router機能"><a class="header" href="#router機能">router機能</a></h1>
<p>実際の web アプリケーションでは，処理ごとにページを分けて行いたい場合が多い．</p>
<p>ここまでの実装では，1 つのページに全てのコンポーネントを表示していたが，本項ではコンポーネントを別ページで表現する．そのままの記述ではページ遷移が行えないので，新しく<code>react-router</code>のライブラリをインストールする．</p>
<h2 id="react-routerのインストール"><a class="header" href="#react-routerのインストール"><code>react-router</code>のインストール</a></h2>
<p>ターミナルで<strong>作業ディレクトリにいることを確認</strong>し，下記コマンドを実行する．</p>
<pre><code class="language-bash">$ npm install react-router-dom
</code></pre>
<blockquote>
<p>【解説】ルーティング</p>
<ul>
<li>通常，React で web アプリケーションを実装すると，コンポーネントが切り替わっても URL は変化しない．</li>
<li>この 2 つを関連づけて，URL からアプリ内の特定のコンポーネントにアクセスできるようにしたり，逆にアプリ内での状態変化を URL に反映させたりすることをルーティングと呼ぶ．</li>
<li>ルーティングしておくと，ブラウザの戻るボタンで戻ったり，URL を打って特定のページに直接アクセスできたりするのでいい感じになる．</li>
</ul>
</blockquote>
<h2 id="ルーティングの定義"><a class="header" href="#ルーティングの定義">ルーティングの定義</a></h2>
<p><code>react-router</code>の機能を用いてルーティングを実装する．</p>
<p><code>App.jsx</code>を以下のように編集する．</p>
<pre><code class="language-jsx">// App.jsx
import React from 'react';
import Booklist from './components/Booklist';
import { BrowserRouter, Route, Link } from 'react-router-dom';  // 追加

const App = () =&gt; {
  const languages = ['React', 'Vue', 'Angular'];
  return (
    &lt;BrowserRouter&gt;
      &lt;h1&gt;react app&lt;/h1&gt;
      &lt;Route exact path='/' component={Booklist} /&gt;
      &lt;Route path='/vue' component={Booklist} /&gt;
      &lt;Route path='/angular' component={Booklist} /&gt;
    &lt;/BrowserRouter&gt;
  );
}
export default App;
</code></pre>
<ul>
<li><code>&lt;BrowserRouter&gt;</code>の中に<code>&lt;Route&gt;</code>を置き，<code>path</code>に対応させたい URL を，<code>component</code>に描画したいコンポーネントを渡す．</li>
<li><code>exact</code>を設定しないと<code>path</code>が入力した URL に前方一致していれば描画されるため（全部<code>/</code>で認識されてしまう），<code>path='/'</code>には<code>exact</code>を設定している．</li>
<li>この時点では，各コンポーネントに<code>props</code>を渡していないため，URL を変更しても表示は変化しない．</li>
</ul>
<blockquote>
<p><strong>💡 Key Point</strong></p>
<p>router機能を使用したい場合は，コンポーネントを必ず<code>&lt;BrowserRouter&gt;</code>内に配置すること．</p>
</blockquote>
<h2 id="ルーティングしながら-props-を渡す"><a class="header" href="#ルーティングしながら-props-を渡す">ルーティングしながら props を渡す</a></h2>
<ul>
<li>せっかく<code>props</code>でデータを渡していたので，ルーティング使用時も<code>props</code>を活用したい．</li>
<li>しかし，<code> component={Booklist}</code>のように記述すると props を記述する場所がない．</li>
<li><code>render</code>を使用すると<code>props</code>を使用できる．</li>
</ul>
<p><code>App.jsx</code>を以下のように編集する．</p>
<pre><code class="language-jsx">// App.jsx
import React from &quot;react&quot;;
import { Booklist } from &quot;./components/Booklist&quot;;
import { BrowserRouter, Route, Link } from 'react-router-dom';

const App = () =&gt; {
  const languages = [&quot;React&quot;, &quot;Vue&quot;, &quot;Angular&quot;];
  return (
    &lt;BrowserRouter&gt;
      &lt;h1&gt;react app&lt;/h1&gt;
      &lt;Route
        exact
        path=&quot;/&quot;
        render={(props) =&gt; &lt;Booklist language={languages[0]} /&gt;}
      /&gt;
      &lt;Route
        path=&quot;/vue&quot;
        render={(props) =&gt; &lt;Booklist language={languages[1]} /&gt;}
      /&gt;
      &lt;Route
        path=&quot;/angular&quot;
        render={(props) =&gt; &lt;Booklist language={languages[2]} /&gt;}
      /&gt;
    &lt;/BrowserRouter&gt;
  );
};
export default App;

</code></pre>
<p>こうするとルーティングと<code>props</code>を併用できる．</p>
<p>ブラウザで<code>localhost:3000/vue</code>などと URL を入力して表示を確認しよう．</p>
<p><img src="day01/./img/mainview06.png" alt="メイン画面6" /></p>
<h2 id="リンクを貼る"><a class="header" href="#リンクを貼る">リンクを貼る</a></h2>
<ul>
<li>毎回 URL 入力はダルい．</li>
<li>せっかくルーティングを実装したので，リンクを張ってブラウザ上で移動できるようにしたい．</li>
<li><code>react-router</code>の<code>Link</code>機能を使うと簡単にリンクを作成できる．</li>
</ul>
<p><code>App.jsx</code>を以下のように編集する．</p>
<pre><code class="language-jsx">// App.jsx
import React from &quot;react&quot;;
import { Booklist } from &quot;./components/Booklist&quot;;
import { BrowserRouter, Route, Link } from 'react-router-dom';

const App = () =&gt; {
  const languages = [&quot;React&quot;, &quot;Vue&quot;, &quot;Angular&quot;];
  return (
    &lt;BrowserRouter&gt;
      &lt;h1&gt;react app&lt;/h1&gt;
      &lt;ul&gt;
        &lt;li&gt;
          &lt;Link to=&quot;/&quot;&gt;React&lt;/Link&gt;
        &lt;/li&gt;
        &lt;li&gt;
          &lt;Link to=&quot;/vue&quot;&gt;Vue&lt;/Link&gt;
        &lt;/li&gt;
        &lt;li&gt;
          &lt;Link to=&quot;/angular&quot;&gt;Angular&lt;/Link&gt;
        &lt;/li&gt;
      &lt;/ul&gt;
      &lt;hr /&gt;
      &lt;Route
        exact
        path=&quot;/&quot;
        render={(props) =&gt; &lt;Booklist language={languages[0]} /&gt;}
      /&gt;
      &lt;Route
        path=&quot;/vue&quot;
        render={(props) =&gt; &lt;Booklist language={languages[1]} /&gt;}
      /&gt;
      &lt;Route
        path=&quot;/angular&quot;
        render={(props) =&gt; &lt;Booklist language={languages[2]} /&gt;}
      /&gt;
    &lt;/BrowserRouter&gt;
  );
};
export default App;

</code></pre>
<p><code>&lt;Link&gt;</code>タグの<code>to</code>部分に移動したい URL を書いておくと，<code>&lt;a&gt;</code>タグのようにリンクしてくれる．</p>
<p>ブラウザ画面で移動できることを確認しよう．</p>
<p><img src="day01/./img/mainview07.png" alt="メイン画面7" /></p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="子コンポーネントへの関数入力"><a class="header" href="#子コンポーネントへの関数入力">子コンポーネントへの関数入力</a></h1>
<p>ページごとにコンポーネントを表示できたので，それぞれのページでキーワードから本のデータを取得したい．</p>
<p>子コンポーネントで関数を定義してもよいが，今回は<code>App.jsx</code>で関数を定義して子コンポーネントに渡す（関数の渡し方の練習）．</p>
<h2 id="関数の定義をpropsの-1-つとして渡す"><a class="header" href="#関数の定義をpropsの-1-つとして渡す">関数の定義を<code>props</code>の 1 つとして渡す</a></h2>
<p><code>App.jsx</code>を以下のように編集する</p>
<pre><code class="language-jsx">// App.jsx
import React from &quot;react&quot;;
import { Booklist } from &quot;./components/Booklist&quot;;
import { BrowserRouter, Route, Link } from 'react-router-dom';

const App = () =&gt; {

  // 関数を追加
  const getDataFromAPI = (keyword) =&gt; {
    return `${keyword} books`;
  };

  const languages = [&quot;React&quot;, &quot;Vue&quot;, &quot;Angular&quot;];
  return (
    &lt;BrowserRouter&gt;
      &lt;h1&gt;react app&lt;/h1&gt;
      &lt;ul&gt;
        &lt;li&gt;
          &lt;Link to=&quot;/&quot;&gt;React&lt;/Link&gt;
        &lt;/li&gt;
        &lt;li&gt;
          &lt;Link to=&quot;/vue&quot;&gt;Vue&lt;/Link&gt;
        &lt;/li&gt;
        &lt;li&gt;
          &lt;Link to=&quot;/angular&quot;&gt;Angular&lt;/Link&gt;
        &lt;/li&gt;
      &lt;/ul&gt;
      &lt;hr /&gt;
      &lt;Route
        exact
        path=&quot;/&quot;
        render={(props) =&gt; &lt;Booklist language={languages[0]} getData={getDataFromAPI} /&gt;}
      /&gt;
      &lt;Route
        path=&quot;/vue&quot;
        render={(props) =&gt; &lt;Booklist language={languages[1]} /&gt;}
      /&gt;
      &lt;Route
        path=&quot;/angular&quot;
        render={(props) =&gt; &lt;Booklist language={languages[2]} /&gt;}
      /&gt;
    &lt;/BrowserRouter&gt;
  );
};
export default App;

</code></pre>
<p>ここでは「<code>getData</code>」という名前で「keyword を入力すると<code>getDataFromApi(keyword)</code>を実行する関数」を「<code>Booklist</code>コンポーネント」に渡している．</p>
<h2 id="propsからの受け取りと関数の実行"><a class="header" href="#propsからの受け取りと関数の実行">propsからの受け取りと関数の実行</a></h2>
<p>続いて，<code>Booklist</code>コンポーネントで関数を受け取って実行する．</p>
<p>子コンポーネントで，読み込み時に渡された関数を実行してその結果を要素に反映する．</p>
<pre><code class="language-jsx">// Booklist.jsx
import React from &quot;react&quot;;

export const Booklist = ({ language, getData }) =&gt; {

  const result = getData?.(language); // `?`を使用することで，`getData`が存在する場合のみ関数を実行できる

  return (
    &lt;&gt;
      &lt;p&gt;this is {result} list component&lt;/p&gt;
    &lt;/&gt;
  );
};

</code></pre>
<p>ブラウザで確認すると「react books」のように表示がされていることがわかる．<code>Vue</code>と<code>Angular</code>の部分は関数を渡していないので表示がされない状態で OK．</p>
<p><img src="day01/./img/mainview08.png" alt="メイン画面8" /></p>
<p>ここまでうまく行ったら，<code>App.jsx</code>内の<code>&lt;Route&gt;</code>要素残り 2 つも同様に追記しよう．</p>
<pre><code class="language-jsx">// App.jsx
import React from &quot;react&quot;;
import { Booklist } from &quot;./components/Booklist&quot;;
import { BrowserRouter, Route, Link } from 'react-router-dom';

const App = () =&gt; {
  const getDataFromAPI = (keyword) =&gt; {
    return `${keyword} books`;
  };

  const languages = [&quot;React&quot;, &quot;Vue&quot;, &quot;Angular&quot;];
  return (
    &lt;BrowserRouter&gt;
      &lt;h1&gt;react app&lt;/h1&gt;
      &lt;ul&gt;
        &lt;li&gt;
          &lt;Link to=&quot;/&quot;&gt;React&lt;/Link&gt;
        &lt;/li&gt;
        &lt;li&gt;
          &lt;Link to=&quot;/vue&quot;&gt;Vue&lt;/Link&gt;
        &lt;/li&gt;
        &lt;li&gt;
          &lt;Link to=&quot;/angular&quot;&gt;Angular&lt;/Link&gt;
        &lt;/li&gt;
      &lt;/ul&gt;
      &lt;hr /&gt;
      &lt;Route
        exact
        path=&quot;/&quot;
        render={(props) =&gt; &lt;Booklist language={languages[0]} getData={getDataFromAPI} /&gt;}
      /&gt;
      &lt;Route
        path=&quot;/vue&quot;
        render={(props) =&gt; &lt;Booklist language={languages[1]} getData={getDataFromAPI} /&gt;}
      /&gt;
      &lt;Route
        path=&quot;/angular&quot;
        render={(props) =&gt; &lt;Booklist language={languages[2]} getData={getDataFromAPI} /&gt;}
      /&gt;
    &lt;/BrowserRouter&gt;
  );
};
export default App;

</code></pre>
<p>ブラウザで操作し，うまくいけば OK．これで親コンポーネントで定義した関数を子コンポーネントに渡すことができた．</p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="httpリクエストの実装"><a class="header" href="#httpリクエストの実装">httpリクエストの実装</a></h1>
<ul>
<li>子コンポーネントに関数が渡せたが，現状では入力値に文字列を追加して出力するだけの関数である．</li>
<li>そこで，指定したキーワードで Google books API からデータを取得する処理に変更する．</li>
<li>http リクエストには<code>axios</code>を使用する．</li>
</ul>
<h2 id="axiosライブラリのインストール"><a class="header" href="#axiosライブラリのインストール">axiosライブラリのインストール</a></h2>
<p>下記コマンドでインストール．</p>
<pre><code class="language-bash">$ npm install axios
</code></pre>
<p>エラーがでなければ OK．</p>
<h2 id="リクエスト関数を実装"><a class="header" href="#リクエスト関数を実装">リクエスト関数を実装</a></h2>
<p><code>App.jsx</code>の<code>getDataFromAPI</code>関数を編集する．</p>
<pre><code class="language-jsx">// App.jsx
import axios from 'axios';	// 追加

// ...省略

// 関数の内容を編集
const getDataFromAPI = async (keyword) =&gt; {
  const requestUrl = 'https://www.googleapis.com/books/v1/volumes?q=intitle:'
  const result = await axios.get(`${requestUrl}${keyword}`);
  return result;
}

// ...省略

</code></pre>
<p>※この記述だけでは動きません！！</p>
<h2 id="コンポーネントで関数を実行するusestate-useeffect"><a class="header" href="#コンポーネントで関数を実行するusestate-useeffect">コンポーネントで関数を実行する（useState, useEffect）</a></h2>
<p>子コンポーネントで<code>getDataFromAPI</code>関数を実行したいが，以下 2 つの問題がある．</p>
<ul>
<li>子コンポーネントは関数であるため，取得したデータを保持できない．</li>
<li>データ更新時にレンダリングが再実行されるため，API リクエストが無限ループになる．</li>
</ul>
<p>前者の問題には<code>useState</code>，後者の問題には<code>useEffect</code>という機能を使うことで対処できる．</p>
<p>（<code>useState</code>と<code>useEffect</code>は React の標準の機能なのでインストールなどの作業は必要ない）</p>
<p><code>Booklist.jsx</code>を下記のように編集する．</p>
<pre><code class="language-jsx">// Booklist.jsx
import React, { useState, useEffect } from &quot;react&quot;; // 追加

export const Booklist = ({ language, getData }) =&gt; {

  const [bookData, setBookData] = useState(null); // ここから追加

  useEffect(() =&gt; {
    const result = getData?.(language)
      .then((response) =&gt; setBookData(response));
  }, [language, getData]);

  // ここまで追加

  return (
    &lt;&gt;
      &lt;p&gt;this is {JSON.stringify(bookData)} list component&lt;/p&gt;
    &lt;/&gt;
  );
};

</code></pre>
<p>ブラウザで確認すると，以下のように取得したデータが文字列で表示される．</p>
<p><img src="day01/./img/mainview09.png" alt="メイン画面9" /></p>
<h2 id="解説usestate"><a class="header" href="#解説usestate">【解説】useState</a></h2>
<ul>
<li>useState は関数コンポーネントが値（今回は API から取得したデータ）を保持するための機能．</li>
<li><code>const [bookData, setBookData] = useState(null);</code>の<code>bookData</code>がデータを保持するための変数名，<code>setBookData</code>がデータを更新するための関数，<code>useState(null)</code>の<code>null</code>が<code>bookData</code>の初期値となる．</li>
<li><code>setBookData(最新の値)</code>のように記述することで，<code>bookData</code>の値が最新の値に更新される．</li>
<li><code>bookData</code>に保存した内容を表示したいときなどは通常の変数のように扱えば OK．</li>
</ul>
<h2 id="解説useeffect"><a class="header" href="#解説useeffect">【解説】useEffect</a></h2>
<ul>
<li>関数外の副作用（外部からのデータ取得や DOM の更新など）を扱うための機能．</li>
<li>React では，コンポーネント内でデータの更新があると再レンダリングされるため，API からデータを取得すると毎回レンダリングが発生して無限ループとなってしまう．</li>
<li>useEffect はレンダリングを制限し，特定の値が更新されたときのみ処理が実行されるようにしてくれる機能．</li>
<li>書式は以下のような感じ．</li>
</ul>
<pre><code class="language-jsx">useEffect(() =&gt; {
  実行したい処理
}, [ここに書いた値（今回は`language`と`getData`）が更新されたときのみ，上の{}内が実行される．ここに値を書くときは配列で書く]);
</code></pre>
<blockquote>
<p><strong>💡 Key Point</strong></p>
<p><code>useState</code>と<code>useEffect</code>以外にもhooksには便利な機能が存在する．</p>
<p>まずはこの2つを使うことで多くの処理を実装可能であるため，まずはこの2つを扱えるようになろう．</p>
</blockquote>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="表示の調整"><a class="header" href="#表示の調整">表示の調整</a></h1>
<p>現状では取得したデータを全て文字列で表示しているだけなので，書籍のタイトルがリスト表示されるよう整える．</p>
<p>booksData から必要なデータを取り出して<code>map()</code>関数で<code>&lt;li&gt;</code>タグをつくる．</p>
<pre><code class="language-jsx">// Booklist.jsx
import React, { useState, useEffect } from &quot;react&quot;;

export const Booklist = ({ language, getData }) =&gt; {

  const [bookData, setBookData] = useState(null);

  useEffect(() =&gt; {
    const result = getData?.(language)
      .then((response) =&gt; setBookData(response));
  }, [language, getData]);

  return (
    &lt;ul&gt;
      {bookData.data.items.map((x, index) =&gt; &lt;li key={index}&gt;{x.volumeInfo.title}&lt;/li&gt;)}
    &lt;/ul&gt;
  );
};

</code></pre>
<p>ブラウザで表示を確認するとエラーになる．</p>
<p><img src="day01/./img/mainview10.png" alt="メイン画面10" /></p>
<p>このエラーの原因は，まだ API からデータを取得していない状態でレンダリングしようとして<code>map()</code>関数が実行されているためである．<code>map()</code>関数は配列に対して処理を行う関数だが，配列のデータが存在しない状態で実行しようとしているためエラーとなる．</p>
<p>三項演算子を使用して，<code>bookData</code>の有無で表示を切り替えることで回避できる．</p>
<ul>
<li><code>bookData</code>が<code>null</code>の場合はローディング中のメッセージを表示．</li>
<li>データが取得できたらリスト表示に切り替え．</li>
</ul>
<pre><code class="language-jsx">// Booklist.jsx
import React, { useState, useEffect } from &quot;react&quot;;

export const Booklist = ({ language, getData }) =&gt; {
  const [bookData, setBookData] = useState(null);
  useEffect(() =&gt; {
    const result = getData?.(language)
      .then((response) =&gt; setBookData(response));
  }, [language, getData]);
  return (
    &lt;ul&gt;
      {
        bookData === null
          ? &lt;p&gt;now loading...&lt;/p&gt;
          : bookData.data.items.map((x, index) =&gt; &lt;li key={index}&gt;{x.volumeInfo.title}&lt;/li&gt;)
      }
    &lt;/ul&gt;
  );
};

</code></pre>
<p>このように表示されれば OK！</p>
<p><img src="day01/./img/mainview11.png" alt="メイン画面11" /></p>
<p>リンククリックするとリストも切り替わる挙動になっている（はず）．</p>
<blockquote>
<p><strong>💡 Key Point</strong></p>
<p>このように，Reactではデータの取得とレンダリングのタイミングなどでハマることが多い．</p>
<p>まずはエラーをよく読むことと，目的のデータが存在しているかどうか，どんな形のデータになっているのかを確認しながら進めると良い．</p>
</blockquote>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="課題任意"><a class="header" href="#課題任意">課題（任意）</a></h1>
<ul>
<li>本のタイトル以外のデータ（著者や画像）の表示．</li>
<li>別の API を使用してデータをブラウザに表示．</li>
</ul>
<p>今回はここまで( `･ω･)b</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
